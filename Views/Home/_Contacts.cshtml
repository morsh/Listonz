<div data-bind="with: contacts">
    <div data-bind="showHide: loaded" class="vm-view vm-contacts">
        <div data-bind="ifnot: showEditor()">
            <table>
                <thead>
                    <tr>
                        <th>Id</th>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Company</th>
                        <th>Category</th>
                    </tr>
                </thead>
                <tbody data-bind="foreach: collection">
                    <tr>
                        <td data-bind="text: Id"></td>
                        <td data-bind="text: FirstName"></td>
                        <td data-bind="text: LastName"></td>
                        <td><span data-bind="if: Company != null"><span data-bind="text: Company.FirstName"></span></span></td>
                        <td data-bind="text: Category"></td>
                        <td>
                            <button class="btn btn-mini btn-danger" data-bind="click: $parent.edit">edit</button></td>
                        <td>
                            <button class="btn btn-mini btn-danger" data-bind="click: $parent.remove">remove</button></td>
                    </tr>
                </tbody>
            </table>
            <input type="button" id="btnGetcontacts" value="Get contacts" data-bind="click: refresh" />
            <input type="button" value="Add" data-bind="click: edit" />
        </div>
        <div data-bind="if: showEditor" class="edit">
            <div data-bind=" { with: select(), jqValidation: validationContext } ">
                <section class="head">
                    <div class="prf-pic"><img src="~/Images/profile.jpg" width="70px" /></div>
                    <div>
                        <h2>
                            <span data-bind="if: FirstName() == '' && LastName() == '' && $parent.isNew()">Add New Contact</span>
                            <span data-bind="text: FirstName"></span>
                            <span data-bind="text: LastName"></span>
                        </h2>
                    </div>
                    <div class="email">
                        <a data-bind="attr: { href: 'mailto:' + Email() }">
                            <div class="float-left"><img src="~/Images/email.png" height="20" /></div>
                            <div data-bind="if: Email() == ''" class="float-left">No Email Found</div>
                            <div data-bind="text: Email" class="float-left"></div>
                        </a>
                    </div>
                    <div class="rating">
                        <div data-bind="rateit: { value: Rating, max: 5, step: 0.1 }"></div>
                    </div>
                </section>
                <ul class="float-left">
                    <li>
                        <span><input type="text" data-bind="value: FirstName" placeholder="First Name" data-required="true" /></span>
                    </li>
                    <li>
                        <span><input type="text" data-bind="value: LastName" placeholder="Last Name" /></span>
                    </li>
                    <li>
                        <span>
                            <hidden data-bind="value: CompanyId" />
                            <input type="text" placeholder="Company" data-bind="
                                value: $parent.EditCompanyName,
                                autocomplete_select: 'UpdateCompany',
                                autoComplete: $parent.api + $parent.options.getAll + '?$filter=substringof(\'REP_URL\',FirstName) and Category eq \'Company\''" /></span>
                    </li>
                    <li>
                        <span><input type="text" data-bind="value: Country" placeholder="Country" /></span>
                    </li>
                    <li>
                        <span><input type="text" data-bind="value: State" placeholder="State" /></span>
                    </li>
                    <li>
                        <span><input type="text" data-bind="value: City" placeholder="City" /></span>
                    </li>
                    <li>
                        <span><input type="text" data-bind="value: Street" placeholder="Street" /></span>
                    </li>
                    <li>
                        <span><textarea data-bind="value: Notes" placeholder="Notes" data-required="true"></textarea></span>
                    </li>
                </ul>
                <ul class="float-right">
                    <li>
                        <span>
                            <input type="text"
                                data-bind="value: Category"
                                placeholder="Category"
                                data-required="true"
                                data-lengthreq="4-16"
                                data-msg_empty="Category is required too."
                                data-msg_lengthreq="Category must be between $MINLEN$ and $MAXLEN$ characters long." /></span>
                    </li>
                    <li>
                        <span>
                            <input type="text"
                                data-bind="value: Email"
                                placeholder="Email"
                                data-required="true"
                                data-email="true" /></span>
                    </li>
                    <li>
                        <span><input type="tel" data-bind="value: PhoneNumber" placeholder="Phone Number" data-phone="true" data-validate="true" /></span>
                    </li>
                    <li>
                        <span><input type="text" data-bind="value: MobileNumber" placeholder="Mobile Number" data-phone="true" data-validate="true" /></span>
                    </li>
                    <li>
                        <span><input type="text" data-bind="value: FaxNumber" placeholder="Fax Number" data-phone="true" data-validate="true" /></span>
                    </li>
                    <li>
                        <span><input type="text" data-bind="value: Birthday" placeholder="Birthday" /></span>
                    </li>
                    <li class="chk-height">
                        <input type="checkbox" data-bind="checked: Single" />
                        <label onclick="$(this).prev().click()">Single</label>
                    </li>
                    <li>
                        <span>
                            <input type="text" data-bind="value: SocialSecurity" placeholder="Social Security / ID" /></span>
                    </li>
                    <li>
                        <span>
                            <input type="text" data-bind="value: DrivingLisence" placeholder="Driving Lisence" /></span>
                    </li>
                    <li>
                        <label style="white-space:nowrap">
                            <span>Last Update: </span>
                            <span data-bind="text: moment(LastUpdate()).format('LL')"></span>
                        </label>
                    </li>
                </ul>
                <div class="float-left clear-both">
                    <div data-bind="foreach: $parent.validationErrors">
                        <div data-bind="text: $data"></div>
                    </div>
                    <input type="button" value="Save" data-bind="click: $parent.save" />
                    <input type="button" value="Cancel" data-bind="click: $parent.cancelEdit" />
                </div>
            </div>
        </div>
    </div>
</div>
